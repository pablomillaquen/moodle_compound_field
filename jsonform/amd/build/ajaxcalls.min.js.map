{"version":3,"sources":["../src/ajaxcalls.js"],"names":["editor","loadform","userid","fieldid","promisesLoad","ajax","call","methodname","args","fail","exception","then","data","length","val","actualData","JSON","parse","JSONEditor","setValue","Error","updateform","dataformat","type","promisesUpdate","window","console","log","location","replace","getform","promises","element","document","getElementById","schema","param1","theme","iconlib","disable_edit_json","disable_properties","disable_collapse","prompt_before_delete","template","catch","bind"],"mappings":"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","sourcesContent":["import $ from \"jquery\";\nimport { exception } from \"core/notification\";\nimport ajax from \"core/ajax\";\nimport { JSONEditor } from \"local_jsonform/jsoneditor\";\n\nvar editor;\nconst loadform = (userid, fieldid)=>{\n    const promisesLoad = ajax.call([{\n        methodname: \"local_jsonform_loadjson\",\n        args: {userid, fieldid},\n        fail: exception\n    }]);\n    promisesLoad[0].then(data => {\n        if(data.length > 0){\n            $('#data').val(data[0].data);\n            let actualData = JSON.parse(data[0].data);\n            JSONEditor.setValue(actualData);\n        }else{\n            return Error;\n        }\n        return(data.length > 0 ? data[0].data : \"No data\");\n        window.console.log(data);\n    });\n};\n\nconst updateform = (userid, fieldid, data, dataformat, type)=>{\n    const promisesUpdate = ajax.call([{\n        methodname: \"local_jsonform_updatejson\",\n        args: {data:data, userid:userid, fieldid:fieldid, dataformat:dataformat, type:type},\n        fail: exception\n    }]);\n    promisesUpdate[0].then(data => {\n        window.console.log(data);\n        window.location.replace(\"/user/profile.php?id=\"+userid);\n    });\n};\n\nconst getform = (userid, fieldid)=>{\n\n    const promises = ajax.call([{\n        methodname: \"local_jsonform_getform\",\n        args: {fieldid:fieldid},\n        fail: exception\n    }]);\n\n    const promisesLoad = ajax.call([{\n        methodname: \"local_jsonform_loadjson\",\n        args: {userid, fieldid},\n        fail: exception\n    }]);\n\n    promises[0].then(data => {\n        const element = document.getElementById('editor_holder');\n        editor = new JSONEditor(element, {\n            schema:JSON.parse(data[0].param1),\n            theme: 'bootstrap4',\n            iconlib: \"fontawesome4\",\n            disable_edit_json:true,\n            disable_properties:true,\n            disable_collapse:true,\n            prompt_before_delete: false,\n            template: 'mustache'\n        });\n    }).then(()=>{\n        return promisesLoad[0];\n    }).then(data=>{\n        if(data[0].data){\n            editor.setValue(JSON.parse(data[0].data));\n            $('#data').val(data[0].data);\n        }\n    }).catch(window.console.log.bind(console));\n};\n\nexport { loadform, updateform, getform, editor };"],"file":"ajaxcalls.min.js"}